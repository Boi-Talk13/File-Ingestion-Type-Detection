<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>File Ingestion & Type Detection</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
body{background:#f5f6fa;color:#2c2c2c}

/* NAVBAR */
.navbar{
    position:fixed;top:0;width:100%;height:64px;
    background:#fff;display:flex;justify-content:space-between;
    align-items:center;padding:0 32px;
    border-bottom:1px solid #e5e7eb;z-index:1000
}
.brand{font-size:18px;font-weight:600}
.nav-right{display:flex;gap:12px}
.btn{padding:8px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
.btn.login{background:transparent;border:1px solid #e74c3c;color:#e74c3c}
.btn.signup{background:#e74c3c;color:#fff}

/* MAIN */
.container{max-width:900px;margin:140px auto;text-align:center}
h1{font-size:44px;margin-bottom:10px}
.subtitle{font-size:20px;color:#555}
.support-text{margin:15px 0 50px;font-size:14px;color:#777}

/* DROP ZONE */
#dropZone{
    background:#fff;border-radius:16px;padding:50px;
    box-shadow:0 10px 30px rgba(0,0,0,.08)
}
#selectBtn{
    background:#e74c3c;color:#fff;font-size:20px;
    padding:18px 60px;border-radius:12px;border:none;cursor:pointer
}
.hint{margin-top:15px;color:#666}
.file-count{margin-top:12px;font-size:14px;color:#444}

/* UPLOAD */
#uploadBtn{
    margin-top:25px;padding:14px 45px;font-size:18px;
    border-radius:12px;border:none;background:#2ecc71;color:#fff;
    cursor:pointer
}
#uploadBtn:disabled{background:#bdbdbd}

/* RESULT BOX (RED LINE) */
#resultBox{
    margin-top:40px;
    background:#fff;
    border-radius:12px;
    padding:25px;
    text-align:left;
    border-left:6px solid #e74c3c;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    white-space:pre-wrap;
    display:none;
}
</style>
</head>

<body>

<nav class="navbar">
  <div class="brand">File Ingestion & Type Detection</div>
  <div class="nav-right">
    <button class="btn login" onclick="location.href='/login.html'">Login</button>
    <button class="btn signup" onclick="location.href='/signup.html'">Sign up</button>
  </div>
</nav>

<main class="container">
  <h1>File Ingestion & Type Detection</h1>
  <p class="subtitle">Upload and validate files</p>
  <p class="support-text">
    Upload any supported format (PDF, DOCX, PPTX, XLSX, CSV, TXT, Images, ZIP, JSON)
  </p>

  <div id="dropZone">
    <button id="selectBtn" type="button">Select files</button>
    <p class="hint">or drop files here</p>
    <input type="file" id="fileInput" multiple hidden>
    <p id="fileCount" class="file-count"></p>
  </div>

  <button id="uploadBtn" disabled>Upload</button>

  <!-- RESULT -->
  <div id="resultBox"></div>
</main>

<script>
const selectBtn = document.getElementById("selectBtn");
const fileInput = document.getElementById("fileInput");
const uploadBtn = document.getElementById("uploadBtn");
const fileCount = document.getElementById("fileCount");
const resultBox = document.getElementById("resultBox");

let selectedFiles = [];

/* OPEN FILE PICKER */
selectBtn.onclick = () => fileInput.click();

/* FILE SELECT */
fileInput.onchange = () => {
    selectedFiles = [...fileInput.files];
    fileCount.textContent = selectedFiles.length
        ? `${selectedFiles.length} file(s) selected`
        : "";
    uploadBtn.disabled = selectedFiles.length === 0;
};

/* UPLOAD */
uploadBtn.onclick = async () => {
    const formData = new FormData();
    selectedFiles.forEach(f => formData.append("files", f));

    uploadBtn.disabled = true;
    uploadBtn.textContent = "Uploading...";
    resultBox.style.display = "block";
    resultBox.textContent = "Uploading...\n";

    const res = await fetch("/upload", {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    resultBox.textContent = "";

    data.forEach(f => {
        resultBox.textContent +=
`--------------------------------
File Name   : ${f.file_name}
File Type   : ${f.file_type?.toUpperCase()}
Size (KB)   : ${f.size_kb}
Hash        : ${f.hash}
Status      : ${f.status}
Mime Type   : ${f.mime_type}
Uploaded At : ${f.uploaded_at}
Duplicate   : ${f.duplicate}
Scan Status : ${f.scan_status}

`;
    });

    uploadBtn.textContent = "Upload";
    uploadBtn.disabled = false;
};
</script>

</body>
</html>